- name: Dynamic paritition
  gather_facts: No
  remote_user: apache
  become: true
  become_method: sudo
  hosts: "{{ Host }}"
  vars_prompt:
   - name: Host
     prompt: "Enter Host ip"
     private: no

   - name: Remove docker if installed from CentOS repo
     yum:
       name:
        - docker
        - docker-client
        - docker-client-latest
        - docker-common
        - docker-latest
        - docker-latest-logrotate
        - docker-logrotate
        - docker-engine
       state: removed
     register: remove

   - name: unwanted softwares removed successfully
     debug:
       var: remove.results

   - name: Install yum utils
     yum:
       name: yum-utils
       state: latest

   - name: Install device-mapper-persistent-data
     yum:
       name: device-mapper-persistent-data
       state: latest

   - name: Install lvm2
     yum:
       name: lvm2
       state: latest

   - name: Adding docker repo
     yum_repository:
      name: download.docker.com_linux_centos_7_x86_64_stable_
      description: download.docker.com_linux_centos_7_x86_64_stable_
      file: download.docker.com_linux_centos_7_x86_64_stable_
      baseurl: "https://download.docker.com/linux/centos/7/x86_64/stable/"
      enabled: yes

   - name: Install Docker
     shell: "yum install --nobest docker-ce -y"
     register: docker

   - name: docker installed successfully
     debug:
       var: docker

   - name: Start Docker service
     service:
       name: docker
       state: started
       enabled: yes
     become: yes
     register: d_service

   - name: docker service started successfully
     debug:
       var: d_service

   - name: docker-py
     shell: "pip3 install docker"


